select Undervisningstyp, case when Lärare is '' then 'Lärarlöst' else Lärare end as Lärare, sum( ((strftime('%H',datetime(slutdatum||' '|| (case when sluttid='00:00' then '24:00' else sluttid end))) - strftime('%H',datetime(startdatum||' '||starttid)) ) * 60 + (strftime('%M',datetime(slutdatum||' '||sluttid)) - strftime('%M',datetime(startdatum||' '||starttid)) ) )/60)  + (sum( (strftime('%M',datetime(slutdatum||' '||(case when sluttid='00:00' then '24:00' else sluttid end))) - strftime('%M',datetime(startdatum||' '|| starttid)) ) + case when substr(starttid,4,2)>substr(sluttid,4,2) then 60 else 0 end )/60) as hours,(sum( (strftime('%M',datetime(slutdatum||' '||(case when sluttid='00:00' then '24:00' else sluttid end))) - strftime('%M',datetime(startdatum||' '|| starttid)) ) + case when substr(starttid,4,2)>substr(sluttid,4,2) then 60 else 0 end )%60) as minutes from tig015h18 group by undervisningstyp, lärare;
