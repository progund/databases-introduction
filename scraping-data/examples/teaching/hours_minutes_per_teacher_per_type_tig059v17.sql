select LÃ¤rare, Undervisningstyp, (sum(strftime('%s', (slutdatum||' '||sluttid)) - strftime('%s', startdatum||' '||starttid) + case when substr(starttid, 3, 2) > substr(sluttid, 3, 2) then 60*60 else 0 end - case when substr(starttid, 3, 2)>substr(sluttid, 3, 2) then 3600 else 0 end )/3600 + sum(strftime('%s', (slutdatum||' '||sluttid)) - strftime('%s', startdatum||' '||starttid) + case when substr(starttid, 3, 2) > substr(sluttid, 3, 2) then 60*60 else 0 end - case when substr(starttid, 3, 2) > substr(sluttid, 3, 2) then 3600 else 0 end))/3600 as hours, sum(strftime('%s', (slutdatum||' '||sluttid)) - strftime('%s', startdatum||' '||starttid))/60%60 as mins from tig059v17 group by lÃ¤rare, undervisningstyp order by hours desc;
